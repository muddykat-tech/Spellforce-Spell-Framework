\doxysection{sf\+\_\+ai\+\_\+hook.\+c}
\hypertarget{sf__ai__hook_8c_source}{}\label{sf__ai__hook_8c_source}\index{src/internal/core/hooks/sf\_ai\_hook.c@{src/internal/core/hooks/sf\_ai\_hook.c}}
\mbox{\hyperlink{sf__ai__hook_8c}{Go to the documentation of this file.}}
\begin{DoxyCode}{0}
\DoxyCodeLine{\Hypertarget{sf__ai__hook_8c_source_l00001}00001\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{sf__ai__hook_8h}{sf\_ai\_hook.h}}"{}}}
\DoxyCodeLine{\Hypertarget{sf__ai__hook_8c_source_l00002}00002\ }
\DoxyCodeLine{\Hypertarget{sf__ai__hook_8c_source_l00003}00003\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{sf__wrappers_8h}{../sf\_wrappers.h}}"{}}}
\DoxyCodeLine{\Hypertarget{sf__ai__hook_8c_source_l00004}00004\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{sf__hooks_8h}{../sf\_hooks.h}}"{}}}
\DoxyCodeLine{\Hypertarget{sf__ai__hook_8c_source_l00005}00005\ }
\DoxyCodeLine{\Hypertarget{sf__ai__hook_8c_source_l00006}00006\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{sf__ai__avoidance__registry_8h}{../../registry/ai\_data\_registries/sf\_ai\_avoidance\_registry.h}}"{}}}
\DoxyCodeLine{\Hypertarget{sf__ai__hook_8c_source_l00007}00007\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{sf__ai__single__target__registry_8h}{../../registry/ai\_data\_registries/sf\_ai\_single\_target\_registry.h}}"{}}}
\DoxyCodeLine{\Hypertarget{sf__ai__hook_8c_source_l00008}00008\ }
\DoxyCodeLine{\Hypertarget{sf__ai__hook_8c_source_l00009}\mbox{\hyperlink{sf__ai__hook_8c_a30823a9211a51bf169522f4aa64f18cb}{00009}}\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{sf__ai__hook_8c_a30823a9211a51bf169522f4aa64f18cb}{clearAction}}(\mbox{\hyperlink{sf__general__structures_8h_a07619fa231562f2cc55bd33173b4c765}{SF\_SGtFigureAction}}\ *\_this)}
\DoxyCodeLine{\Hypertarget{sf__ai__hook_8c_source_l00010}00010\ \{}
\DoxyCodeLine{\Hypertarget{sf__ai__hook_8c_source_l00011}00011\ \ \ \ \ \_this-\/>type\ =\ 0xffff;}
\DoxyCodeLine{\Hypertarget{sf__ai__hook_8c_source_l00012}00012\ \ \ \ \ \_this-\/>subtype\ =\ 0;}
\DoxyCodeLine{\Hypertarget{sf__ai__hook_8c_source_l00013}00013\ \ \ \ \ \_this-\/>unkn2\ =\ 0;}
\DoxyCodeLine{\Hypertarget{sf__ai__hook_8c_source_l00014}00014\ \ \ \ \ \_this-\/>unkn3\ =\ 0;}
\DoxyCodeLine{\Hypertarget{sf__ai__hook_8c_source_l00015}00015\ \ \ \ \ \_this-\/>unkn4\ =\ 0;}
\DoxyCodeLine{\Hypertarget{sf__ai__hook_8c_source_l00016}00016\ \ \ \ \ \_this-\/>unkn5\ =\ 0;}
\DoxyCodeLine{\Hypertarget{sf__ai__hook_8c_source_l00017}00017\ \}}
\DoxyCodeLine{\Hypertarget{sf__ai__hook_8c_source_l00018}00018\ \textcolor{comment}{//\ TODO\ MOVE\ ME}}
\DoxyCodeLine{\Hypertarget{sf__ai__hook_8c_source_l00019}00019\ }
\DoxyCodeLine{\Hypertarget{sf__ai__hook_8c_source_l00020}\mbox{\hyperlink{sf__ai__hook_8c_adbfebe2587f5680512bab3f489b05a2b}{00020}}\ \textcolor{keywordtype}{bool}\ \mbox{\hyperlink{sf__ai__hook_8c_adbfebe2587f5680512bab3f489b05a2b}{isSpellAction}}(\mbox{\hyperlink{sf__general__structures_8h_a07619fa231562f2cc55bd33173b4c765}{SF\_SGtFigureAction}}\ *\_this)}
\DoxyCodeLine{\Hypertarget{sf__ai__hook_8c_source_l00021}00021\ \{}
\DoxyCodeLine{\Hypertarget{sf__ai__hook_8c_source_l00022}00022\ \ \ \ \ \textcolor{keywordflow}{if}\ ((\_this-\/>type\ !=\ 0)\ \&\&\ (\_this-\/>type\ <\ 10000))}
\DoxyCodeLine{\Hypertarget{sf__ai__hook_8c_source_l00023}00023\ \ \ \ \ \{}
\DoxyCodeLine{\Hypertarget{sf__ai__hook_8c_source_l00024}00024\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{true};}
\DoxyCodeLine{\Hypertarget{sf__ai__hook_8c_source_l00025}00025\ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{sf__ai__hook_8c_source_l00026}00026\ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{\Hypertarget{sf__ai__hook_8c_source_l00027}00027\ \}}
\DoxyCodeLine{\Hypertarget{sf__ai__hook_8c_source_l00028}00028\ }
\DoxyCodeLine{\Hypertarget{sf__ai__hook_8c_source_l00029}\mbox{\hyperlink{sf__ai__hook_8c_ae8785a71043ac84c08d23c97623a4bdc}{00029}}\ uint16\_t\ \_\_thiscall\ \mbox{\hyperlink{sf__ai__hook_8c_ae8785a71043ac84c08d23c97623a4bdc}{getSector}}(\mbox{\hyperlink{sf__general__structures_8h_ae200cc761d9e4257e978beaa16ca50a3}{SF\_CGdWorld}}\ *\_this,\ \mbox{\hyperlink{sf__general__structures_8h_aa44e45471f7b6c436abe46e7d9d728c9}{SF\_Coord}}\ *position)}
\DoxyCodeLine{\Hypertarget{sf__ai__hook_8c_source_l00030}00030\ \{}
\DoxyCodeLine{\Hypertarget{sf__ai__hook_8c_source_l00031}00031\ \ \ \ \ uint32\_t\ index\ =\ position-\/>X\ +\ position-\/>Y\ *\ 0x400;}
\DoxyCodeLine{\Hypertarget{sf__ai__hook_8c_source_l00032}00032\ \ \ \ \ \textcolor{keywordflow}{return}\ \_this-\/>cells[index].sector;}
\DoxyCodeLine{\Hypertarget{sf__ai__hook_8c_source_l00033}00033\ \}}
\DoxyCodeLine{\Hypertarget{sf__ai__hook_8c_source_l00034}00034\ }
\DoxyCodeLine{\Hypertarget{sf__ai__hook_8c_source_l00035}\mbox{\hyperlink{sf__ai__hook_8c_a8b05ede347b93b11df8a6d828d3f1776}{00035}}\ uint32\_t\ \mbox{\hyperlink{sf__ai__hook_8c_a8b05ede347b93b11df8a6d828d3f1776}{GetEuclideanDistanceFromRing}}(\textcolor{keywordtype}{int}\ x1,\ \textcolor{keywordtype}{int}\ y1,\ \textcolor{keywordtype}{int}\ x2,\ \textcolor{keywordtype}{int}\ y2,\ \textcolor{keywordtype}{int}\ inner\_radius,\ \textcolor{keywordtype}{int}\ outer\_radius)}
\DoxyCodeLine{\Hypertarget{sf__ai__hook_8c_source_l00036}00036\ \{}
\DoxyCodeLine{\Hypertarget{sf__ai__hook_8c_source_l00037}00037\ \ \ \ \ \textcolor{keywordtype}{int}\ iVar1;}
\DoxyCodeLine{\Hypertarget{sf__ai__hook_8c_source_l00038}00038\ }
\DoxyCodeLine{\Hypertarget{sf__ai__hook_8c_source_l00039}00039\ \ \ \ \ iVar1\ =\ (y1\ -\/\ y2)\ *\ (y1\ -\/\ y2)\ +\ (x1\ -\/\ x2)\ *\ (x1\ -\/\ x2);}
\DoxyCodeLine{\Hypertarget{sf__ai__hook_8c_source_l00040}00040\ \ \ \ \ \textcolor{keywordflow}{if}\ (iVar1\ <\ (inner\_radius\ *\ inner\_radius\ -\/\ 1))}
\DoxyCodeLine{\Hypertarget{sf__ai__hook_8c_source_l00041}00041\ \ \ \ \ \{}
\DoxyCodeLine{\Hypertarget{sf__ai__hook_8c_source_l00042}00042\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ inner\_radius\ *\ inner\_radius\ -\/\ iVar1;}
\DoxyCodeLine{\Hypertarget{sf__ai__hook_8c_source_l00043}00043\ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{sf__ai__hook_8c_source_l00044}00044\ \ \ \ \ \textcolor{keywordflow}{if}\ ((outer\_radius\ *\ outer\_radius\ +\ 1)\ <\ iVar1)}
\DoxyCodeLine{\Hypertarget{sf__ai__hook_8c_source_l00045}00045\ \ \ \ \ \{}
\DoxyCodeLine{\Hypertarget{sf__ai__hook_8c_source_l00046}00046\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ iVar1\ -\/\ outer\_radius\ *\ outer\_radius;}
\DoxyCodeLine{\Hypertarget{sf__ai__hook_8c_source_l00047}00047\ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{sf__ai__hook_8c_source_l00048}00048\ \ \ \ \ \textcolor{keywordflow}{return}\ 0;}
\DoxyCodeLine{\Hypertarget{sf__ai__hook_8c_source_l00049}00049\ \}}
\DoxyCodeLine{\Hypertarget{sf__ai__hook_8c_source_l00050}00050\ }
\DoxyCodeLine{\Hypertarget{sf__ai__hook_8c_source_l00051}\mbox{\hyperlink{sf__ai__hook_8c_a4ff157855ad65cfd8f8e94d74fa35998}{00051}}\ uint32\_t\ \mbox{\hyperlink{sf__ai__hook_8c_a4ff157855ad65cfd8f8e94d74fa35998}{signum}}(uint32\_t\ param\_1)}
\DoxyCodeLine{\Hypertarget{sf__ai__hook_8c_source_l00052}00052\ \{}
\DoxyCodeLine{\Hypertarget{sf__ai__hook_8c_source_l00053}00053\ \ \ \ \ \textcolor{keywordflow}{return}\ (param\_1\ \string^\ (\textcolor{keywordtype}{int})param\_1\ >>\ 0x1f)\ -\/\ ((int)param\_1\ >>\ 0x1f);}
\DoxyCodeLine{\Hypertarget{sf__ai__hook_8c_source_l00054}00054\ \}}
\DoxyCodeLine{\Hypertarget{sf__ai__hook_8c_source_l00055}00055\ }
\DoxyCodeLine{\Hypertarget{sf__ai__hook_8c_source_l00056}\mbox{\hyperlink{sf__ai__hook_8c_af54f024fccce5a4ae77213ac9f815c2c}{00056}}\ uint32\_t\ \mbox{\hyperlink{sf__ai__hook_8c_af54f024fccce5a4ae77213ac9f815c2c}{rank\_support\_spell\_hook}}(\mbox{\hyperlink{struct_s_f___c_gd_battle_development}{SF\_CGdBattleDevelopment}}\ *\_this,\ uint16\_t\ target\_index,\ uint16\_t\ spell\_line,\ \mbox{\hyperlink{sf__spell__functions_8h_a89b47ba315c541ed76ff336111d27c5d}{SF\_CGdResourceSpell}}\ *spell\_data)}
\DoxyCodeLine{\Hypertarget{sf__ai__hook_8c_source_l00057}00057\ \{}
\DoxyCodeLine{\Hypertarget{sf__ai__hook_8c_source_l00058}00058\ \ \ \ \ \textcolor{keywordtype}{bool}\ isStackable\ =\ \mbox{\hyperlink{sf__wrappers_8c_aad92c6ec5283b3732feeefd0d62ab629}{hasSpellTag}}(spell\_line,\ \mbox{\hyperlink{sf__general__structures_8h_a42506507e4f7b927f1ec61d982197ff6a2799ca0988a588f1e6a32587ef17c12a}{STACKABLE\_SPELL}});}
\DoxyCodeLine{\Hypertarget{sf__ai__hook_8c_source_l00059}00059\ \ \ \ \ \mbox{\hyperlink{sf__registration__functions_8h_a87df9b4cbebca6416ebbf724d2e93292}{ai\_single\_handler\_ptr}}\ handler\ =\ \mbox{\hyperlink{sf__ai__single__target__registry_8cpp_a971d5f33ee21660e72921eacc54daa80}{get\_single\_ai\_handler}}(spell\_line);}
\DoxyCodeLine{\Hypertarget{sf__ai__hook_8c_source_l00060}00060\ \ \ \ \ uint32\_t\ rank\ =\ handler(\_this,\ target\_index,\ spell\_line,\ spell\_data);}
\DoxyCodeLine{\Hypertarget{sf__ai__hook_8c_source_l00061}00061\ \ \ \ \ \textcolor{keywordflow}{if}\ ((\mbox{\hyperlink{_test_mod_8cpp_af5cc9e62d950cef0fc6386b8162d5cf0}{toolboxAPI}}.hasSpellOnIt(\_this-\/>battleData.CGdFigureToolBox,\ target\_index,\ spell\_line))\ \&\&\ (!isStackable))}
\DoxyCodeLine{\Hypertarget{sf__ai__hook_8c_source_l00062}00062\ \ \ \ \ \{}
\DoxyCodeLine{\Hypertarget{sf__ai__hook_8c_source_l00063}00063\ \ \ \ \ \ \ \ \ rank\ =\ 0;}
\DoxyCodeLine{\Hypertarget{sf__ai__hook_8c_source_l00064}00064\ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{sf__ai__hook_8c_source_l00065}00065\ \ \ \ \ \textcolor{keywordflow}{return}\ rank;}
\DoxyCodeLine{\Hypertarget{sf__ai__hook_8c_source_l00066}00066\ \}}

\end{DoxyCode}
